# Netlify Environment Variables for Neon DB Migration
# Set these in your Netlify dashboard under Site settings > Environment variables

# =============================================================================
# REQUIRED CONFIGURATION
# =============================================================================

# NextAuth.js Configuration (REQUIRED)
NEXTAUTH_URL=https://your-site-name.netlify.app
NEXTAUTH_SECRET=your-super-secret-jwt-secret-change-this-in-production-min-32-chars

# Admin Credentials (CHANGE THESE FOR PRODUCTION!)
ADMIN_EMAIL=admin@yourcompany.com
ADMIN_PASSWORD=your-secure-admin-password-min-8-chars

# Neon DB Configuration (REQUIRED for PostgreSQL)
NEON_DATABASE_URL=postgresql://username:password@ep-example-123456.us-east-1.aws.neon.tech/dbname?sslmode=require

# =============================================================================
# CONNECTION POOL CONFIGURATION
# =============================================================================

# Maximum number of connections in the pool
# Recommended: 10-20 for Neon Free tier, 20-50 for Pro tier
NEON_MAX_CONNECTIONS=20

# Time in milliseconds before closing idle connections
# Recommended: 30000 (30 seconds) for serverless environments
NEON_IDLE_TIMEOUT=30000

# Time in milliseconds to wait for a connection
# Recommended: 10000 (10 seconds) for most applications
NEON_CONNECTION_TIMEOUT=10000

# =============================================================================
# SSL AND SECURITY CONFIGURATION
# =============================================================================

# SSL mode for Neon connections (always required for Neon)
# Options: require, verify-ca, verify-full
# Note: This is typically included in NEON_DATABASE_URL
NEON_SSL_MODE=require

# =============================================================================
# OPTIONAL CONFIGURATION
# =============================================================================

# Database seeding (set to false for production)
SEED_DATABASE=false

# Enable query logging for debugging (set to false for production)
ENABLE_QUERY_LOGGING=false

# Migration configuration
AUTO_MIGRATE_ON_STARTUP=false
BACKUP_BEFORE_MIGRATION=true

# Performance monitoring
ENABLE_PERFORMANCE_MONITORING=true
SLOW_QUERY_THRESHOLD=1000

# Node Environment
NODE_ENV=production

# Application version (for health checks)
APP_VERSION=1.0.0

# =============================================================================
# NEON-SPECIFIC CONFIGURATION
# =============================================================================

# Neon region (for latency optimization)
# Options: us-east-1, us-west-2, eu-central-1, ap-southeast-1
NEON_REGION=us-east-1

# Neon compute endpoint (optional, for advanced configurations)
# NEON_COMPUTE_ENDPOINT=ep-example-123456

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Netlify-specific settings
NETLIFY_REGION=us-east-1
NETLIFY_FUNCTION_TIMEOUT=30

# Build configuration
BUILD_COMMAND=npm run build
PUBLISH_DIRECTORY=.next

# =============================================================================
# INSTRUCTIONS
# =============================================================================

# 1. COPY TO NETLIFY DASHBOARD:
#    Go to Site settings > Environment variables and add each variable

# 2. NEON DATABASE SETUP:
#    - Create a Neon database at https://neon.tech
#    - Copy the connection string from your Neon dashboard
#    - Replace NEON_DATABASE_URL with your actual connection string

# 3. SECURITY CONFIGURATION:
#    - Generate NEXTAUTH_SECRET: openssl rand -base64 32
#    - Set your actual domain in NEXTAUTH_URL
#    - Use strong admin credentials (min 8 characters)

# 4. CONNECTION POOL TUNING:
#    - Free tier: NEON_MAX_CONNECTIONS=10
#    - Pro tier: NEON_MAX_CONNECTIONS=20-50
#    - Scale tier: NEON_MAX_CONNECTIONS=50-100

# 5. PERFORMANCE OPTIMIZATION:
#    - Choose NEON_REGION closest to your users
#    - Set NEON_IDLE_TIMEOUT based on your traffic patterns
#    - Enable monitoring in development, disable in production

# 6. MIGRATION SETUP:
#    - Set AUTO_MIGRATE_ON_STARTUP=true for automatic schema updates
#    - Keep BACKUP_BEFORE_MIGRATION=true for safety

# =============================================================================
# VALIDATION
# =============================================================================

# After setting up, test your configuration:
# 1. Deploy to Netlify
# 2. Visit https://your-site.netlify.app/api/health-postgres
# 3. Check https://your-site.netlify.app/api/diagnostics-postgres
# 4. Verify all checks pass

# =============================================================================
# TROUBLESHOOTING
# =============================================================================

# Common issues:
# - Connection timeout: Increase NEON_CONNECTION_TIMEOUT
# - Too many connections: Reduce NEON_MAX_CONNECTIONS
# - SSL errors: Ensure sslmode=require in connection string
# - Slow queries: Enable ENABLE_QUERY_LOGGING for debugging